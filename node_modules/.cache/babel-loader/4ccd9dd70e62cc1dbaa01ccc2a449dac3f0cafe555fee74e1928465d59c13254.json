{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const ImageGallery=_ref=>{let{selectedDate}=_ref;const[images,setImages]=useState([]);const[error,setError]=useState(null);const feedId=\"fekiizlmvw6b\";const apiKey=\"HWN2M2mcbZoyFDTfpaskQV9TBDk0Ir8bu4XWDxJQiBE\";const apiBaseUrl=\"https://www.teleport.io/api/v2\";useEffect(()=>{fetchImages(selectedDate);},[selectedDate]);const fetchImages=async date=>{setError(null);const startTime=\"\".concat(date.toISOString().split('T')[0],\"T00:00:00Z\");const endTime=\"\".concat(date.toISOString().split('T')[0],\"T23:59:59Z\");const interval=3600;const queryUrl=\"\".concat(apiBaseUrl,\"/frame-query?feedid=\").concat(feedId,\"&starttime=\").concat(startTime,\"&endtime=\").concat(endTime,\"&interval=\").concat(interval,\"&apikey=\").concat(apiKey);try{console.log(\"Fetching images from:\",queryUrl);const response=await fetch(queryUrl);if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();console.log(\"Received data:\",data);if(!data.Frames||!Array.isArray(data.Frames)){throw new Error(\"Invalid data format received from API\");}const imageUrls=data.Frames.map(frameTime=>({url:\"\".concat(apiBaseUrl,\"/frame-get?feedid=\").concat(feedId,\"&frametime=\").concat(frameTime,\"&sizecode=1080p&apikey=\").concat(apiKey),timestamp:frameTime}));setImages(imageUrls);}catch(error){console.error(\"Error fetching images:\",error);setError(error.message);}};if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-red-500\",children:[\"Error loading images: \",error]});}const download=imagen=>{var element=document.createElement(\"a\");var file=new Blob([imagen.url],{type:\"image/*\"});element.href=URL.createObjectURL(file);element.download=\"image.jpg\";element.click();};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[\"Se han encontrado \",images.length,\" imagenes para el dia \",selectedDate.toDateString()]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 font-bold\",children:\"Atencion! Espere unos segundos a que la imagen cargue.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 gap-4\",children:images.map((image,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"relative cursor-pointer\",children:/*#__PURE__*/_jsxs(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",download:true,onClick:()=>download(image),children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2 bg-white bg-opacity-70 p-1 rounded text-xs\",children:new Date(image.timestamp).toLocaleTimeString()}),/*#__PURE__*/_jsx(\"img\",{src:image.url,alt:\"Image \".concat(index),className:\"w-full h-full object-cover rounded\",onError:e=>{console.error(\"Error loading image \".concat(index,\":\"),e);e.target.src='https://via.placeholder.com/150?text=Image+Load+Error';}}),/*#__PURE__*/_jsx(\"span\",{className:\"absolute bottom-2 right-2 text-white text-xl cursor-pointer\",title:\"Download\",children:\"\\u2B07\"})]})},index))})]});};export default ImageGallery;","map":{"version":3,"names":["React","useState","useEffect","jsxs","_jsxs","jsx","_jsx","ImageGallery","_ref","selectedDate","images","setImages","error","setError","feedId","apiKey","apiBaseUrl","fetchImages","date","startTime","concat","toISOString","split","endTime","interval","queryUrl","console","log","response","fetch","ok","Error","status","data","json","Frames","Array","isArray","imageUrls","map","frameTime","url","timestamp","message","className","children","download","imagen","element","document","createElement","file","Blob","type","href","URL","createObjectURL","click","length","toDateString","image","index","target","rel","onClick","Date","toLocaleTimeString","src","alt","onError","e","title"],"sources":["C:/Users/faust/OneDrive/Documents/GitHub/lisual-dashboard/src/ImageGallery.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nconst ImageGallery = ({ selectedDate }) => {\r\n  const [images, setImages] = useState([]);\r\n  const [error, setError] = useState(null);\r\n  const feedId = \"fekiizlmvw6b\";\r\n  const apiKey = \"HWN2M2mcbZoyFDTfpaskQV9TBDk0Ir8bu4XWDxJQiBE\";\r\n  const apiBaseUrl = \"https://www.teleport.io/api/v2\";\r\n\r\n  useEffect(() => {\r\n    fetchImages(selectedDate);\r\n  }, [selectedDate]);\r\n\r\n  const fetchImages = async (date) => {\r\n    setError(null);\r\n    const startTime = `${date.toISOString().split('T')[0]}T00:00:00Z`;\r\n    const endTime = `${date.toISOString().split('T')[0]}T23:59:59Z`;\r\n    const interval = 3600;\r\n\r\n    const queryUrl = `${apiBaseUrl}/frame-query?feedid=${feedId}&starttime=${startTime}&endtime=${endTime}&interval=${interval}&apikey=${apiKey}`;\r\n\r\n    try {\r\n      console.log(\"Fetching images from:\", queryUrl);\r\n      const response = await fetch(queryUrl);\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      const data = await response.json();\r\n      console.log(\"Received data:\", data);\r\n      \r\n      if (!data.Frames || !Array.isArray(data.Frames)) {\r\n        throw new Error(\"Invalid data format received from API\");\r\n      }\r\n\r\n      const imageUrls = data.Frames.map(frameTime => ({\r\n        url: `${apiBaseUrl}/frame-get?feedid=${feedId}&frametime=${frameTime}&sizecode=1080p&apikey=${apiKey}`,\r\n        timestamp: frameTime\r\n      }));\r\n      \r\n      setImages(imageUrls);\r\n    } catch (error) {\r\n      console.error(\"Error fetching images:\", error);\r\n      setError(error.message);\r\n    }\r\n  };\r\n\r\n  if (error) {\r\n    return <div className=\"text-red-500\">Error loading images: {error}</div>;\r\n  }\r\n\r\n  const download = (imagen) => {\r\n    var element = document.createElement(\"a\");\r\n    var file = new Blob(\r\n      [\r\n        imagen.url\r\n      ],\r\n      { type: \"image/*\" }\r\n    );\r\n    element.href = URL.createObjectURL(file);\r\n    element.download = \"image.jpg\";\r\n    element.click();\r\n  };\r\n  return (\r\n    <div>\r\n      <div className=\"mb-4\">Se han encontrado {images.length} imagenes para el dia {selectedDate.toDateString()}</div>\r\n      <div className=\"mb-4 font-bold\">Atencion! Espere unos segundos a que la imagen cargue.</div>\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        {images.map((image, index) => (\r\n          <div key={index} className=\"relative cursor-pointer\">\r\n            <a target=\"_blank\" rel=\"noopener noreferrer\" download onClick={()=> download(image)}>\r\n              <div className=\"absolute top-2 left-2 bg-white bg-opacity-70 p-1 rounded text-xs\">\r\n                {new Date(image.timestamp).toLocaleTimeString()}\r\n              </div>\r\n              <img \r\n                src={image.url} \r\n                alt={`Image ${index}`} \r\n                className=\"w-full h-full object-cover rounded\"\r\n                onError={(e) => {\r\n                  console.error(`Error loading image ${index}:`, e);\r\n                  e.target.src = 'https://via.placeholder.com/150?text=Image+Load+Error';\r\n                }}\r\n              />\r\n              <span className=\"absolute bottom-2 right-2 text-white text-xl cursor-pointer\" title=\"Download\">â¬‡</span>\r\n            </a>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageGallery;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}